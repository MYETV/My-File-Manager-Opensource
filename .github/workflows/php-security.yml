name: Check for dangerous functions
  run: |
    echo "Checking for potentially dangerous PHP functions..."
    DANGEROUS=$(grep -rnE '\b(eval|exec|system|shell_exec|proc_open|popen)\s*\(' src/ --exclude-dir=vendor | grep -v 'ffmpeg' | grep -v 'video_process' | grep -v 'PATHTOFILES')
    if [ -n "$DANGEROUS" ]; then
      echo "❌ Found dangerous function usage"
      echo "$DANGEROUS"
      exit 1
    fi
    if PASSTHRU=$(grep -rnE '\bpassthru\s*\(' src/ --exclude-dir=vendor | grep -v 'fpassthru'); [ -n "$PASSTHRU" ]; then
      echo "❌ Found passthru() usage (not fpassthru)"
      echo "$PASSTHRU"
      exit 1
    fi
    echo "✅ No dangerous functions found"
